t√¥i mu·ªën x√¢y d·ª±ng trang Login v√† Signup react native expo. d·ª±a v√†o api v√† code b√™n d∆∞·ªõi.
T√¥i c√≥ code trang login d·ª± √°n web chung backend v·ªõi app n√†y, c√≥ th·ªÉ tham kh·∫£o v√† l√†m l·∫°i kh√¥ng


//frontend\src\components\auth\Login.jsx react web
/* component react hi·ªÉn th·ªã form ƒëƒÉng nh·∫≠p*/
import React, { useEffect, useState } from "react"
import { useLoginMutation } from "../../redux/api/authApi"; // auto ch√®n khi ch·ªçn useLoginMutation t·ª´ Quick Fix
// import toast from "react-hot-toast"; // auto ch√®n khi ch·ªçn toast t·ª´ Quick Fix
import { toast } from "react-toastify";
import { useNavigate } from "react-router-dom"
import { useSelector } from "react-redux";

// Component Login g·ªìm 2 bi·∫øn email v√† password ƒë∆∞·ª£c kh·ªüi t·∫°o b·∫±ng useState l∆∞u tr·ªØ t·ª´ form
const Login = () => {
  const [email, setEmail] = useState("");
  const [password, setPassword] = useState("");

  const navigate = useNavigate();

  // Hook t·ª´ Redux Toolkit Query ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªÉ request ƒëƒÉng nh·∫≠p. Tr·∫£ v·ªÅ 1 m·∫£ng ch·ª©a h√†m login ƒë·ªÉ g·ª≠i request v·ªÅ m·ªôt ƒë·ªëi t∆∞·ª£ng ch·ª©a tr·∫°ng th√°i c·ªßa request nh∆∞ isLoading, error, data
  const [login, { isLoading, error, data }] = useLoginMutation();

  const { isAuthenticated } = useSelector((state) => state.auth);
  
  console.log("=====================================");
  console.log(data);
  console.log("=====================================");
  // ki·ªÉm tra n·∫øu c√≥ l·ªói request th√¨ hi·ªÉn th·ªã th√¥ng b√°o l·ªói b·∫±ng toast.error
  useEffect(() => {
    if(isAuthenticated){
      navigate("/");
    }
    if(error){
      toast.error(error?.data?.message);
    }
  }, [error, isAuthenticated])
  // x·ª≠ l√Ω s·ª± ki·ªán submit c·ªßa form. Sau ƒë√≥ h√†m login ƒë∆∞·ª£c g·ªçi v·ªõi d·ªØ li·ªáu ƒëƒÉng nh·∫≠p
  const submitHandler = (e) => {
    e.preventDefault();

    // Dispatch login'
    const loginData = {
      email,
      password,
    };

    login(loginData);
  
  };

  return (
    <div className="row wrapper">
      <div className="col-10 col-lg-5">
        <form
          className="shadow rounded bg-body"
          onSubmit={submitHandler}
          action="your_submit_url_here"
          method="post"
        >
          <h2 className="mb-4">ƒêƒÉng nh·∫≠p</h2>
          <div className="mb-3">
            <label htmlFor="email_field" className="form-label">Email</label>
            <input
              type="email"
              id="email_field"
              className="form-control"
              name="email"
              value={email}
              onChange={(e) => setEmail(e.target.value)}
            />
          </div>

          <div className="mb-3">
            <label htmlFor="password_field" className="form-label">M·∫≠t kh·∫©u</label>
            <input
              type="password"
              id="password_field"
              className="form-control"
              name="password"
              value={password}
              onChange={(e) => setPassword(e.target.value)}
            />
          </div>

          <a href="/password/forgot" className="float-end mb-4">Qu√™n M·∫≠t kh·∫©u?</a>

          <button 
            id="login_button" 
            type="submit" 
            className="btn w-100 py-2" 
            disabled={isLoading}
            >
            {isLoading? "ƒêang x√°c th·ª±c..." :"ƒêƒÇNG NH·∫¨P"}
          </button>

          <div className="my-3">
            <a href="/register" className="float-end">Ch∆∞a c√≥ t√†i kho·∫£n?</a>
          </div>
        </form>
      </div>
    </div>
  )
}

export default Login


\---src
    |   AppNavigator.js
    |   
    +---components
    |       Filters.js
    |       ProductItem.js
    |       Sorters.js
    |       
    +---redux
    |   |   store.js
    |   |   
    |   +---api
    |   |       authApi.js
    |   |       orderApi.js
    |   |       productsApi.js
    |   |       userApi.js
    |   |       
    |   \---features
    |           cartSlice.js
    |           userSlice.js
    |           
    \---screens
            HomeScreen.js
            ProductScreen.js
            CategoriesScreen.js
            FavouritesScreen.js
            LoginScreen.js
            ProfileScreen.js
            SignupScreen.js


--------------------------------------

// src/AppNavigator.js
import React from 'react';
import { createStackNavigator } from '@react-navigation/stack';
import MainTab from './MainTab'; // Import ƒë√∫ng MainTab
import ProductScreen from '../screens/ProductScreen';
import LoginScreen from '../screens/LoginScreen';
import SignUpScreen from '../screens/SignupScreen';
// N·∫øu ch∆∞a c√≥ DrawerNavigation, t·∫°m th·ªùi b·ªè qua 
// import DrawerNavigation from './DrawerNavigation';

const Stack = createStackNavigator();

const AppNavigator = () => {
  return (
    <Stack.Navigator>
      {/* MainTab s·∫Ω ch·ª©a c√°c tab ƒëi·ªÅu h∆∞·ªõng ch√≠nh */}
      <Stack.Screen 
        name="Main" 
        component={MainTab} 
        options={{ headerShown: false }} 
      />
      {/* C√°c m√†n h√¨nh kh√°c c√≥ th·ªÉ ƒë∆∞·ª£c ƒëi·ªÅu h∆∞·ªõng t·ª´ c√°c tab */}
      <Stack.Screen 
        name="Product" 
        component={ProductScreen} 
        options={{ headerShown: true, title: "Product Details" }} // Th√™m ti√™u ƒë·ªÅ s·∫£n ph·∫©m
      />
       <Stack.Screen 
        name="Login" 
        component={LoginScreen} 
        options={{ headerShown: true, title: "Login Screen" }} // Th√™m ti√™u ƒë·ªÅ s·∫£n ph·∫©m
      />     
       <Stack.Screen 
        name="SignUp" 
        component={SignUpScreen} 
        options={{ headerShown: true, title: "SignUp Screen" }} // Th√™m ti√™u ƒë·ªÅ s·∫£n ph·∫©m
      />     
    </Stack.Navigator>
  );
};

export default AppNavigator;


--------------------------------------

// src/navigation/HomeStack.js
import React from 'react';
import { createStackNavigator } from '@react-navigation/stack';
import HomeScreen from '../screens/HomeScreen';
import ProductScreen from '../screens/ProductScreen'; // ƒê·∫£m b·∫£o import ƒë√∫ng component

const Stack = createStackNavigator();

const HomeStack = () => {
  return (
    <Stack.Navigator>
      <Stack.Screen 
        name="HomeScreen" 
        component={HomeScreen} 
        options={{ headerShown: false }} // ·∫®n header tr√™n HomeScreen
      />
      <Stack.Screen 
        name="Product"  // ƒê·ªïi th√†nh "Product" thay v√¨ "ProductScreen"
        component={ProductScreen}  // ƒê·∫£m b·∫£o tham chi·∫øu ƒë√∫ng ProductScreen
        options={{ 
          title: 'Product Details',
          headerBackTitleVisible: false, // ·∫®n ti√™u ƒë·ªÅ quay l·∫°i
          headerShown: true // Hi·ªÉn th·ªã header tr√™n ProductScreen
        }}
      />
    </Stack.Navigator>
  );
};

export default HomeStack;


--------------------------------------

// src/navigation/MainTab.js
import React from 'react';
import { createBottomTabNavigator } from '@react-navigation/bottom-tabs';
import Ionicons from 'react-native-vector-icons/Ionicons';
import CategoriesScreen from '../screens/CategoriesScreen';
import FavouritesScreen from '../screens/FavouritesScreen';
import ProfileScreen from '../screens/ProfileScreen';
import HomeStack from './HomeStack';


const Tab = createBottomTabNavigator();

const MainTab = () => {
  return (
    <Tab.Navigator
      screenOptions={({ route }) => ({
        tabBarIcon: ({ focused, color, size }) => {
          let iconName;
          if (route.name === 'Home') iconName = focused ? 'home' : 'home-outline';
          else if (route.name === 'Categories') iconName = focused ? 'grid' : 'grid-outline';
          else if (route.name === 'Favourites') iconName = focused ? 'heart' : 'heart-outline';
          else if (route.name === 'Profile') iconName = focused ? 'person' : 'person-outline';

          return <Ionicons name={iconName} size={size} color={color} />;
        },
        tabBarActiveTintColor: 'blue',
        tabBarInactiveTintColor: 'gray',
      })}
    >
      <Tab.Screen name="Home" component={HomeStack} options={{ headerShown: false }} />
      <Tab.Screen name="Categories" component={CategoriesScreen} options={{ headerShown: false }} />
      <Tab.Screen name="Favourites" component={FavouritesScreen} options={{ tabBarBadge: 3, headerShown: false }} />
      <Tab.Screen name="Profile" component={ProfileScreen} options={{ headerShown: false }} />
    </Tab.Navigator>
  );
};

export default MainTab;


--------------------------------------

// /src\redux\api\authApi.js
import { createApi, fetchBaseQuery } from '@reduxjs/toolkit/query/react';
import { userApi } from './userApi';
import AsyncStorage from '@react-native-async-storage/async-storage'; // Thay v√¨ localStorage

export const authApi = createApi({
  reducerPath: "authApi",
  baseQuery: fetchBaseQuery({
    baseUrl: "http://192.168.1.5:3001/api",  // ƒêi·ªÅu ch·ªânh URL cho React Native
    prepareHeaders: async (headers) => {
      const token = await AsyncStorage.getItem('token');
      if (token) {
        headers.set('Authorization', `Bearer ${token}`);
      }
      return headers;
    },
  }),
  keepUnusedDataFor: 86400,
  endpoints: (builder) => ({
    register: builder.mutation({
      query(body) {
        return {
          url: "/register",
          method: "POST",
          body,
        };
      },
      async onQueryStarted(args, { dispatch, queryFulfilled }) {
        try {
          const { data } = await queryFulfilled;
          await AsyncStorage.setItem('token', data.token); // L∆∞u token v√†o AsyncStorage
          await dispatch(userApi.endpoints.getMe.initiate(null));
        } catch (error) {
          console.log(error);
        }
      },
    }),
    login: builder.mutation({
      query(body) {
        return {
          url: "/login",
          method: "POST",
          body,
        };
      },
      async onQueryStarted(args, { dispatch, queryFulfilled }) {
        try {
          const { data } = await queryFulfilled;
          await AsyncStorage.setItem('token', data.token); // L∆∞u token v√†o AsyncStorage
          await dispatch(userApi.endpoints.getMe.initiate(null));
        } catch (error) {
          console.log(error);
        }
      },
    }),
    logout: builder.query({
      query: () => "/logout",
      async onQueryStarted(args, { dispatch, queryFulfilled }) {
        try {
          await queryFulfilled;
          await AsyncStorage.removeItem('token'); // X√≥a token kh·ªèi AsyncStorage khi logout
        } catch (error) {
          console.log(error);
        }
      },
    }),
  }),
});

// Export c√°c hooks
export const { useLoginMutation, useRegisterMutation, useLazyLogoutQuery } = authApi;


--------------------------------------

//src\redux\api\orderApi.js
import { createApi, fetchBaseQuery } from '@reduxjs/toolkit/query/react';
import AsyncStorage from '@react-native-async-storage/async-storage'; // Import AsyncStorage cho token

export const orderApi = createApi({
  reducerPath: "orderApi",
  baseQuery: fetchBaseQuery({
    baseUrl: "http://192.168.1.5:3001/api",  // ƒêi·ªÅu ch·ªânh baseUrl cho React Native
    // Chu·∫©n b·ªã headers cho c√°c request, bao g·ªìm c·∫£ token t·ª´ AsyncStorage
    prepareHeaders: async (headers) => {
      const token = await AsyncStorage.getItem('token');
      if (token) {
        headers.set('Authorization', `Bearer ${token}`);
      }
      return headers;
    },
  }),
  endpoints: (builder) => ({
    createNewOrder: builder.mutation({
      query(body) {
        return {
          url: "/orders/new",
          method: "POST",
          body,
        };
      },
    }),
    myOrders: builder.query({
      query: () => ({
        url: `/me/orders`,
      }),
    }),
    orderDetails: builder.query({
      query: (id) => ({
        url: `/orders/${id}`,
      }),
    }),
  }),
});

// Export c√°c hooks ƒë·ªÉ s·ª≠ d·ª•ng trong c√°c component
export const { useCreateNewOrderMutation, useMyOrdersQuery, useOrderDetailsQuery } = orderApi;


--------------------------------------

//src\redux\api\productsApi.js
import { createApi, fetchBaseQuery } from '@reduxjs/toolkit/query/react';
import AsyncStorage from '@react-native-async-storage/async-storage'; // Import AsyncStorage cho token

export const productApi = createApi({
  reducerPath: "productApi",
  baseQuery: fetchBaseQuery({
    baseUrl: "http://192.168.1.5:3001/api", // C·∫≠p nh·∫≠t baseUrl cho React Native
    prepareHeaders: async (headers) => {
      const token = await AsyncStorage.getItem('token'); // L·∫•y token t·ª´ AsyncStorage
      if (token) {
        headers.set('Authorization', `Bearer ${token}`);
      }
      return headers;
    },
  }),
  tagTypes: ["Product"],
  keepUnusedDataFor: 86400, // Gi·ªØ cache trong 1 ng√†y
  endpoints: (builder) => ({
    getProducts: builder.query({
      query: (params) => ({
        url: "/products",
        params: {
          page: params?.page,
          keyword: params?.keyword,
          category: params?.category,
          subCategory: params?.subCategory,
          subSubCategory: params?.subSubCategory,
          sort: params?.sort,
          "price[gte]": params?.min,
          "price[lte]": params?.max,
        },
      }),
    }),
    getProductDetails: builder.query({
      query: (id) => `/products/${id}`,
      providesTags: ['Product'],
    }),
    submitReview: builder.mutation({
      query(body) {
        return {
          url: "/reviews",
          method: "PUT",
          body,
        };
      },
      invalidatesTags: ["Product"],
    }),
    canUserReview: builder.query({
      query: (productId) => `/can_review/?productId=${productId}`,
    }),
  }),
});

// Export c√°c hooks ƒë·ªÉ s·ª≠ d·ª•ng trong c√°c component React Native
export const { 
  useGetProductsQuery, 
  useGetProductDetailsQuery, 
  useSubmitReviewMutation, 
  useCanUserReviewQuery 
} = productApi;


--------------------------------------

//src\redux\api\userApi.js
import { createApi, fetchBaseQuery } from '@reduxjs/toolkit/query/react';
import { setIsAuthenticated, setLoading, setUser } from '../features/userSlice';
import AsyncStorage from '@react-native-async-storage/async-storage'; // Import AsyncStorage ƒë·ªÉ l·∫•y token

export const userApi = createApi({
  reducerPath: "userApi",
  baseQuery: fetchBaseQuery({
    baseUrl: "http://192.168.1.5:3001/api", // C·∫≠p nh·∫≠t baseUrl cho React Native
    prepareHeaders: async (headers) => {
      const token = await AsyncStorage.getItem('token'); // L·∫•y token t·ª´ AsyncStorage
      if (token) {
        headers.set('Authorization', `Bearer ${token}`);
      }
      return headers;
    },
  }),
  tagTypes: ["User"], 
  endpoints: (builder) => ({
    getMe: builder.query({
      query: () => ({ url: '/me' }),
      transformResponse: (result) => result.user,
      async onQueryStarted(args, { dispatch, queryFulfilled }) {
        try {
          const { data } = await queryFulfilled;
          dispatch(setUser(data));
          dispatch(setIsAuthenticated(true));
          dispatch(setLoading(false));
        } catch (error) {
          dispatch(setLoading(false));
          console.log(error);
        }
      },
      providesTags: ["User"],
    }),
    updateProfile: builder.mutation({
      query: (body) => ({
        url: "/me/update",
        method: "PUT",
        body,
      }),
      invalidatesTags: ["User"],
    }),
    uploadAvatar: builder.mutation({
      query: (body) => ({
        url: "/me/upload_avatar",
        method: "PUT",
        body,
      }),
      invalidatesTags: ["User"],
    }),
    updatePassword: builder.mutation({
      query: (body) => ({
        url: "/password/update",
        method: "PUT",
        body,
      }),
    }),
    forgotPassword: builder.mutation({
      query: (body) => ({
        url: "/password/forgot",
        method: "POST",
        body,
      }),
    }),
    resetPassword: builder.mutation({
      query: ({ token, body }) => ({
        url: `/password/reset/${token}`,
        method: "PUT",
        body,
      }),
    }),
  }),
});

// Export c√°c hooks ƒë·ªÉ s·ª≠ d·ª•ng trong c√°c component React Native
export const { 
  useGetMeQuery, 
  useUpdateProfileMutation, 
  useUploadAvatarMutation,
  useUpdatePasswordMutation,
  useForgotPasswordMutation,
  useResetPasswordMutation,
} = userApi;


--------------------------------------

//Mobile\src\components\ProductItem.js
import React from 'react';
import { View, Text, Image, StyleSheet } from 'react-native';

const ProductItem = ({ item }) => {
  // Ki·ªÉm tra xem item c√≥ ch·ª©a thu·ªôc t√≠nh images v√† c√≥ √≠t nh·∫•t m·ªôt h√¨nh ·∫£nh
  const imageUrl = item.images && item.images.length > 0 ? item.images[0].url : null;

  return (
    <View style={styles.container}>
      {imageUrl ? (
        <Image source={{ uri: imageUrl }} style={styles.image} />
      ) : (
        <Text>No image available</Text>
      )}
      <Text style={styles.name}>{item.name}</Text>
      <Text style={styles.price}>{item.price.toLocaleString()} VND</Text>
    </View>
  );
};

const styles = StyleSheet.create({
  container: {
    flex: 1,
    margin: 5,
    padding: 10,
    backgroundColor: '#fff',
    borderRadius: 10,
    shadowColor: '#000',
    shadowOpacity: 0.1,
    shadowRadius: 10,
    elevation: 5,
  },
  image: {
    width: '100%',
    height: 150,
    resizeMode: 'contain',
    marginBottom: 10,
  },
  name: {
    fontSize: 16,
    fontWeight: 'bold',
  },
  price: {
    fontSize: 14,
    color: '#ff4500',
  },
});

export default ProductItem;


--------------------------------------

//src\redux\features\cartSlice.js
import { createSlice } from "@reduxjs/toolkit";
import AsyncStorage from '@react-native-async-storage/async-storage';


const initialState = {
  cartItems: [],
  shippingInfo: {},
};

// Function to load data from AsyncStorage
const loadFromAsyncStorage = async (key) => {
  try {
    const value = await AsyncStorage.getItem(key);
    return value ? JSON.parse(value) : null;
  } catch (error) {
    console.log('Error loading data from AsyncStorage:', error);
    return null;
  }
};

// Initial loading of cartItems and shippingInfo from AsyncStorage
const initializeState = async () => {
  const cartItems = await loadFromAsyncStorage('cartItems');
  const shippingInfo = await loadFromAsyncStorage('shippingInfo');
  return {
    cartItems: cartItems || [],
    shippingInfo: shippingInfo || {},
  };
};

export const cartSlice = createSlice({
  name: "cartSlice",
  initialState,
  reducers: {
    setCartItem: (state, action) => {
      const item = action.payload;

      const isItemExist = state.cartItems.find(
        (i) => i.product === item.product
      );

      if (isItemExist) {
        state.cartItems = state.cartItems.map((i) =>
          i.product === isItemExist.product ? item : i
        );
      } else {
        state.cartItems = [...state.cartItems, item];
      }

      // Save updated cartItems to AsyncStorage
      AsyncStorage.setItem("cartItems", JSON.stringify(state.cartItems));
    },
    removeCartItem: (state, action) => {
      state.cartItems = state?.cartItems?.filter(
        (i) => i.product !== action.payload
      );

      // Save updated cartItems to AsyncStorage
      AsyncStorage.setItem("cartItems", JSON.stringify(state.cartItems));
    },
    clearCart: (state) => {
      state.cartItems = [];
      AsyncStorage.removeItem("cartItems"); // Remove from AsyncStorage
    },
    saveShippingInfo: (state, action) => {
      state.shippingInfo = action.payload;

      // Save shippingInfo to AsyncStorage
      AsyncStorage.setItem("shippingInfo", JSON.stringify(state.shippingInfo));
    },
  },
});

export default cartSlice.reducer;

export const { setCartItem, removeCartItem, saveShippingInfo, clearCart } = cartSlice.actions;



--------------------------------------

//src\redux\features\userSlice.js
import { createSlice } from "@reduxjs/toolkit";

const initialState = {
  user: null,
  isAuthenticated: false,
  loading: true,
};

export const userSlice = createSlice({
  initialState,
  name: "userSlice",
  reducers: {
    setUser(state, action) {
      state.user = action.payload;
    },
    setIsAuthenticated(state, action) {
      state.isAuthenticated = action.payload;
    },
    setLoading(state, action) {
      state.loading = action.payload;
    },
  },
});

export default userSlice.reducer;

export const { setIsAuthenticated, setUser, setLoading } = userSlice.actions;


--------------------------------------


//src\redux\store.js
/* store.js trong Redux Toolkit c·∫•u h√¨nh Redux store, l∆∞u tr·ªØ to√†n b·ªô tr·∫°ng th√°i ·ª©ng d·ª•ng. */
import { configureStore } from "@reduxjs/toolkit"; // ref: https://redux-toolkit.js.org/api/configureStore
import userReducer from "./features/userSlice"; // reducer cho tr·∫°ng th√°i ng∆∞·ªùi d√πng
import { productApi } from "./api/productsApi"; // API slice cho s·∫£n ph·∫©m
import { authApi } from "./api/authApi"; // API slice cho x√°c th·ª±c
import { userApi } from "./api/userApi"; // API slice cho ng∆∞·ªùi d√πng
import cartReducer from "./features/cartSlice"; // reducer cho gi·ªè h√†ng
import { orderApi } from "./api/orderApi"; // API slice cho ƒë∆°n h√†ng

export const store = configureStore({
  // D√πng Chrome extension Redux DevTools ƒë·ªÉ theo d√µi c√°c reducers v√† tr·∫°ng th√°i c·ªßa ·ª©ng d·ª•ng
  reducer: {
    // ƒê·ªãnh nghƒ©a c√°c reducer cho ·ª©ng d·ª•ng
    auth: userReducer, // Tr·∫°ng th√°i x√°c th·ª±c
    cart: cartReducer, // Tr·∫°ng th√°i gi·ªè h√†ng
    // C√°c API slices x·ª≠ l√Ω tr·∫°ng th√°i c·ªßa c√°c y√™u c·∫ßu API ·ª©ng d·ª•ng
    [productApi.reducerPath]: productApi.reducer, // API slice cho s·∫£n ph·∫©m
    [authApi.reducerPath]: authApi.reducer, // API slice cho x√°c th·ª±c
    [userApi.reducerPath]: userApi.reducer, // API slice cho ng∆∞·ªùi d√πng
    [orderApi.reducerPath]: orderApi.reducer, // API slice cho ƒë∆°n h√†ng
  },
  // ref: https://redux-toolkit.js.org/rtk-query/usage#adding-the-api-middleware
  // th√™m c√°c middleware t·ª´ c√°c API slices v√†o chu·ªói middleware m·∫∑c ƒë·ªãnh c·ªßa Redux Toolkit
  middleware: (getDefaultMiddleware) =>
    getDefaultMiddleware().concat([
      productApi.middleware, // middleware cho s·∫£n ph·∫©m
      authApi.middleware, // middleware cho x√°c th·ª±c
      userApi.middleware, // middleware cho ng∆∞·ªùi d√πng
      orderApi.middleware, // middleware cho ƒë∆°n h√†ng
    ]),
});


--------------------------------------

// App.js
import React from 'react';
import { NavigationContainer } from '@react-navigation/native';
import { Provider } from 'react-redux';
import { store } from './src/redux/store.js';
import AppNavigator from './src/navigation/AppNavigator.js';

export default function App() {
  return (
    <Provider store={store}>
      {/* Gi·ªØ NavigationContainer ·ªü ƒë√¢y */}
      <NavigationContainer>
        <AppNavigator />
      </NavigationContainer>
    </Provider>
  );
}

----------------------------------


import React, { useEffect } from 'react';
import { View, FlatList, StyleSheet, Text, TouchableOpacity } from 'react-native';
import { useGetProductsQuery } from '../redux/api/productsApi';
import Header from '../components/Header';
import Banner from '../components/Banner';
import ProductItem from '../components/ProductItem';

const HomeScreen = ({ navigation }) => {
  const { data, isLoading, error } = useGetProductsQuery();

  const handleProductPress = (product) => {
    navigation.navigate('Product', { product });
  };

  return (
    <View style={styles.container}>
      <Header navigation={navigation} title="Home" />

      {isLoading ? (
        <Text>Loading products...</Text>
      ) : error ? (
        <Text>Error loading products</Text>
      ) : (
        <FlatList
          ListHeaderComponent={
            <>
              <Banner />
              <View style={styles.hotDealsContainer}>
                <Text style={styles.hotDealsText}>Hot Deals üî•</Text>
              </View>
            </>
          }
          data={data.products}  
          renderItem={({ item }) => (
            <TouchableOpacity onPress={() => handleProductPress(item)}>
              <ProductItem item={item} />
            </TouchableOpacity>
          )}
          keyExtractor={(item) => item._id}  
          numColumns={2}
        />
      )}
    </View>
  );
};

const styles = StyleSheet.create({
  container: {
    flex: 1,
    backgroundColor: '#fff',
  },
  hotDealsContainer: {
    paddingHorizontal: 10,
    paddingVertical: 5,
    backgroundColor: '#ffe4e1',
  },
  hotDealsText: {
    fontSize: 18,
    fontWeight: 'bold',
    color: '#ff4500',
  },
});

export default HomeScreen;


